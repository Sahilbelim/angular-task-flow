<!-- <div class="max-w-6xl mx-auto p-6">

    <h2 class="text-2xl font-bold mb-6 text-blue-700">
        User Management
    </h2>

    @if (loading) {
    <p>Loading users...</p>
    } @else {

    <div class="overflow-x-auto">
        <table class="w-full border rounded-xl overflow-hidden">

            <thead class="bg-blue-50">
                <tr>
                    <th class="p-3  ">Name</th>
                    <th class="p-3">Email</th>
                    <th class="p-3">Role</th>
                    <th class="p-3">Permissions</th>
                    <th class="p-3">Action</th>
                </tr>
            </thead>

            <tbody>
                @for (user of users; track user._id) {
                <tr class="border-t">

                    <td class="p-3 ">{{ user.name }}</td>
                    <td class="p-3">{{ user.email }}</td>
                    <td class="p-3 capitalize">{{ user.role }}</td>

                    @if(user.role === 'admin') {
                    <td class="p-3">Full Access</td>
                    <td><button (click)="updatePermissions(user)" class="px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700">
                        Save
                    </button></td>
                    } @else {

                    <td class="p-3">
                        <div class="flex flex-wrap gap-3 text-sm">
                            <label>
                                <input type="checkbox" [(ngModel)]="user.permissions.create" /> Create
                            </label>

                            <label>
                                <input type="checkbox" [(ngModel)]="user.permissions.edit" /> Edit
                            </label>

                            <label>
                                <input type="checkbox" [(ngModel)]="user.permissions.delete" /> Delete
                            </label>
                        </div>
                    </td>
              

                    <td class="p-3">
                        <button (click)="updatePermissions(user)"
                            class="px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700">
                            Save
                        </button>
                    </td>
}
                </tr>
                }
            </tbody>

        </table>
    </div>
    }

</div> -->
<!-- <app-task></app-task> -->
<!-- 
<div class="bg-white/90 backdrop-blur-xl border rounded-2xl shadow p-6">

    <div class="overflow-x-auto">
        <table class="min-w-[800px] w-full text-sm">

            <thead class="bg-blue-50 text-blue-700">
                <tr>
                    <th class="p-3 text-left">Name</th>
                    <th class="p-3 text-left">Email</th>
                    <th class="p-3 text-center">Role</th>
                    <th class="p-3 text-left">Permissions</th>
                    <th class="p-3 text-center">Action</th>
                </tr>
            </thead>

            <tbody>
                @for (user of users; track user._id) {
                <tr class="border-t hover:bg-blue-50 transition">

                    <td class="p-3 font-medium">{{ user.name }}</td>
                    <td class="p-3">{{ user.email }}</td>
                    <td class="p-3 text-center capitalize">{{ user.role }}</td>

                <td class="p-3">
                    @if (user.role === 'admin') {
                
                   
                    <span class="inline-flex items-center gap-2
                               px-4 py-1.5 rounded-full
                               bg-green-100 text-green-700
                               text-sm font-semibold
                               shadow-sm ">
                     
                        Full Access
                    </span>
                
                    } @else {
                
                  
                    <div class="flex flex-wrap gap-4">
                
                     
                        <label class="flex items-center gap-2 px-3 py-2 rounded-xl
                                   border border-blue-200 bg-blue-50
                                   cursor-pointer
                                   transition-all duration-200
                                   hover:scale-105 hover:shadow-md">
                            <input type="checkbox" [(ngModel)]="user.permissions.create" class="accent-blue-600 scale-110" />
                           
                            <span class="text-sm font-medium text-blue-800">
                                Create
                            </span>
                        </label>
                
                    
                        <label class="flex items-center gap-2 px-3 py-2 rounded-xl
                                   border border-yellow-200 bg-yellow-50
                                   cursor-pointer
                                   transition-all duration-200
                                   hover:scale-105 hover:shadow-md">
                            <input type="checkbox" [(ngModel)]="user.permissions.edit" class="accent-yellow-600 scale-110" />
                           
                            <span class="text-sm font-medium text-yellow-800">
                                Edit
                            </span>
                        </label>
                
                     
                        <label class="flex items-center gap-2 px-3 py-2 rounded-xl
                                   border border-red-200 bg-red-50
                                   cursor-pointer
                                   transition-all duration-200
                                   hover:scale-105 hover:shadow-md">
                            <input type="checkbox" [(ngModel)]="user.permissions.delete" class="accent-red-600 scale-110" />
                           
                            <span class="text-sm font-medium text-red-800">
                                Delete
                            </span>
                        </label>
                
                    </div>
                    }
                </td>


                <td class="p-3 text-center">
                    <button (click)="updatePermissions(user)" [disabled]="user.role === 'admin'" class="px-4 py-2 rounded-xl font-semibold transition
                               disabled:cursor-not-allowed
                               disabled:bg-gray-300
                               disabled:text-gray-500
                               disabled:shadow-none
                               bg-blue-600 text-white hover:bg-blue-700">
                        Save
                    </button>
                </td>


                </tr>
                }
            </tbody>

        </table>
    </div>

</div> -->

<div class="bg-white/90 backdrop-blur-xl border rounded-2xl shadow p-6 space-y-6">

    <!-- FILTER BAR -->
    <div class="flex flex-col md:flex-row gap-4 md:items-center md:justify-between">

        <!-- SEARCH -->
        <input type="text" placeholder="Search by name or email" [(ngModel)]="searchText"
            (ngModelChange)="filterBySearch()" class="w-full md:w-1/3 rounded-xl border border-blue-200
                   bg-blue-50 px-4 py-3
                   focus:ring-2 focus:ring-blue-500 transition" />

        <!-- ROLE FILTER -->
        <select [(ngModel)]="roleFilter" (ngModelChange)="filterByRole()" class="w-full md:w-44 rounded-xl border border-blue-200
                   bg-white px-4  py-3 ">   
            <option value="all">All Roles</option>
            <option value="admin">Admin</option>
            <option value="user">User</option>
        </select>

        <!-- PAGE SIZE -->
        <select [(ngModel)]="selectedPageSize" (ngModelChange)="onPageSizeChange($event)" class="w-full md:w-40 rounded-xl border border-blue-200
                   bg-white px-4 py-3 font-semibold">
            @for (size of pageSizeOptions; track $index) {
            <option [value]="size">{{ size }}</option>
            }
        </select>
       
            <button (click)="open.emit()" class="px-5 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600
                         text-white text-sm sm:text-base font-semibold shadow hover:scale-105 transition">
                Add User
            </button>
    </div>

    <div class="overflow-x-auto">
        <table class="min-w-[800px] w-full text-sm">
    
            <thead class="bg-blue-50 text-blue-700">
                <tr>
                    <th class="p-3 text-left">Name</th>
                    <th class="p-3 text-left">Email</th>
                    <th class="p-3 text-center">Role</th>
                    <th class="p-3 text-left">Permissions</th>
                    <th class="p-3 text-center">Action</th>
                </tr>
            </thead>
    
            <tbody>
                @for (user of filteredUsers | paginate:
                { itemsPerPage: itemsPerPage, currentPage: p };
                track user._id) {
    
            <tr class="border-t
                       hover:bg-blue-50/50
                       transition-colors duration-200">
            
                <!-- NAME -->
                <td class="px-4 py-3 font-medium text-gray-800">
                    {{ user.name }}
                </td>
            
                <!-- EMAIL -->
                <td class="px-4 py-3 text-gray-600">
                    {{ user.email }}
                </td>
            
                <!-- ROLE -->
                <td class="px-4 py-3 text-center">
                    <span class="inline-flex items-center px-3 py-1
                                 rounded-full text-xs font-semibold
                                 bg-slate-100 text-slate-700 capitalize">
                        {{ user.role }}
                    </span>
                </td>
            
                <!-- PERMISSIONS -->
                <td class="px-4 py-3">
            
                    @if (user.role === 'admin') {
            
                    <!-- ADMIN BADGE -->
                    <span class="inline-flex items-center gap-2
                                 px-3 py-1.5
                                 rounded-full
                                 bg-emerald-50 text-emerald-700
                                 text-xs font-semibold">
               
                        Full Access
                    </span>
            
                    } @else {
            
                    <!-- USER PERMISSIONS (TOGGLE STYLE) -->
                    <div class="flex flex-wrap gap-3">
            
                        <!-- CREATE -->
                        <label class="inline-flex items-center gap-2
                                      px-3 py-1.5 rounded-lg
                                      border border-gray-200
                                      bg-white
                                      text-xs font-medium text-gray-700
                                      hover:border-blue-400
                                      hover:text-blue-600
                                      transition">
                            <input type="checkbox" [(ngModel)]="user.permissions.create" class="accent-blue-600" />
                            Create
                        </label>
            
                        <!-- EDIT -->
                        <label class="inline-flex items-center gap-2
                                      px-3 py-1.5 rounded-lg
                                      border border-gray-200
                                      bg-white
                                      text-xs font-medium text-gray-700
                                      hover:border-indigo-400
                                      hover:text-indigo-600
                                      transition">
                            <input type="checkbox" [(ngModel)]="user.permissions.edit" class="accent-indigo-600" />
                            Edit
                        </label>
            
                        <!-- DELETE -->
                        <label class="inline-flex items-center gap-2
                                      px-3 py-1.5 rounded-lg
                                      border border-gray-200
                                      bg-white
                                      text-xs font-medium text-gray-700
                                      hover:border-red-400
                                      hover:text-red-600
                                      transition">
                            <input type="checkbox" [(ngModel)]="user.permissions.delete" class="accent-red-600" />
                            Delete
                        </label>
            
                    </div>
                    }
                </td>
            
                <!-- ACTION -->
                <td class="px-4 py-3 text-center">
                    <button (click)="updatePermissions(user)" [disabled]="user.role === 'admin'" class="px-4 py-1.5   rounded-lg
                                      border border-blue-400
                                      bg-white
                                      text-xs font-medium text-gray-700
                                      hover:border-blue-700
                                      hover:text-blue-600
                                      transition
                                      disabled:border-gray-300
                               disabled:bg-gray-200
                               disabled:text-gray-500
                               disabled:cursor-not-allowed">
                        Save
                    </button>
                </td>
            
            </tr>

                }
            </tbody>
    
        </table>
    </div>

    <div class="flex flex-col md:flex-row md:items-center md:justify-between mt-6 gap-4">
    
        <div class="text-blue-700 font-semibold ">
            Total Users: {{ filteredUsers.length }}
        </div>
    
        <pagination-controls class="text-sm" (pageChange)="p = $event" class="flex justify-center">
        </pagination-controls>
    
    </div>
    </div>