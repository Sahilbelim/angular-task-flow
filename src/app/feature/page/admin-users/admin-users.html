<div class="min-h-screen w-full flex justify-center bg-gradient-to-br from-blue-100 via-sky-100 to-indigo-200 ">

    <div class="w-full max-w-7xl mx-auto p-6 md:mt-3">

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">


            @if (loading) {

            @for(i of [1,2,3]; track $index) {
            <div class="rounded-2xl bg-white/80 p-6 animate-pulse">
                <div class="h-4 w-24 bg-gray-200 rounded mb-3"></div>
                <div class="h-8 w-16 bg-gray-300 rounded mb-2"></div>

            </div>
            }

            }
            @else {

            <div class="relative bg-white/90 backdrop-blur-xl rounded-2xl border border-blue-100 p-6 ">
                <div class="absolute top-5 right-5"><i class='bx text-3xl text-blue-300 bx-check-shield'></i></div>
                <p class="text-sm font-medium text-blue-600 mb-1">
                    Total Users
                </p>

                <h3 class="text-3xl font-extrabold text-gray-800 mb-2">
                    {{5}}
                </h3>

                <p class="text-sm text-gray-500">
                    Users created so far
                </p>
            </div>


            <div class="relative bg-white/90 backdrop-blur-xl rounded-2xl border border-blue-100 p-6 ">
                <div class="absolute top-5 right-5"><i class='bx text-3xl text-orange-200  bx-bolt-alt'></i></div>
                <p class="text-sm font-medium text-orange-400 mb-1">
                    Number of Admins
                </p>

                <h3 class="text-3xl font-extrabold text-gray-800 mb-2">
                    {{2}}
                </h3>

                <p class="text-sm text-gray-500">
                    Users created so far
                </p>
            </div>
            <div class="relative bg-white/90 backdrop-blur-xl rounded-2xl border border-blue-100 p-6 ">
                <div class="absolute top-5 right-5"><i class='bx text-3xl text-orange-200  bx-skull'></i></div>
                <p class="text-sm font-medium text-orange-400 mb-1">
                    Number of Users
                </p>

                <h3 class="text-3xl font-extrabold text-gray-800 mb-2">
                    {{3}}
                </h3>

                <p class="text-sm text-gray-500">
                    Users created so far
                </p>
            </div>

            }


        </div>



        <div class="mt-5 w-full  max-w-7xl bg-white/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_50px_rgba(59,130,246,0.25)]
border border-blue-100 p-8 transition-all duration-300 hover:shadow-[0_25px_70px_rgba(59,130,246,0.35)]  ">
          

            <div class="  ">
            
                <!-- FILTER BAR -->
                <div class="flex flex-col gap-3
                        md:flex-row md:items-center md:justify-between
                        w-full border-b border-blue-200 pb-4">
            
                    <!-- SEARCH -->
                    <input type="text" placeholder="Search by name or email" [(ngModel)]="searchText"
                        (ngModelChange)="filterBySearch()" class="h-12 w-full md:w-2/3
                       rounded-xl
                       border border-blue-200
                       bg-blue-50
                       px-4
                       text-blue-900 placeholder-blue-400
                       focus:ring-2 focus:ring-blue-500
                       transition" />
            
                 
            
                    <!-- PAGE SIZE -->
                    <select [(ngModel)]="selectedPageSize" (ngModelChange)="onPageSizeChange($event)" class="h-12 w-full md:w-40
                       rounded-xl
                       border border-blue-200
                       bg-white
                       px-4
                       font-semibold
                       text-blue-900
                       focus:ring-2 focus:ring-blue-500
                       transition">
                        @for (size of pageSizeOptions; track $index) {
                        <option [value]="size">{{ size }}</option>
                        }
                    </select>
            
                    <!-- ADD USER BUTTON -->
                    <button (click)="open.emit()" class="h-12 min-w-[120px]
                       rounded-xl
                       bg-gradient-to-r from-blue-600 to-indigo-600
                       text-white font-semibold
                       flex items-center justify-center
                       px-5
                       shadow
                       hover:scale-[1.03]
                       active:scale-[0.98]
                       transition">
                        Add User
                    </button>
            
                </div>
            
            
                <div class="overflow-x-auto  ">
                    <table class="min-w-[800px] w-full text-base  text-black   ">
            
                        <thead class=" ">
                            <tr class="bg-white border-b text-left">
                                <th class="p-3 text-left">Name</th>
                                <th class="p-3 text-center  ">Email</th>
                                <th class="p-3 text-center">Role</th>
                                <!-- <th class="p-3 text-left">Permissions</th> -->
                                <th class="p-3 text-left">Action</th>
                            </tr>
                        </thead>
            
                        <tbody>
                            @for (user of filteredUsers | paginate:
                            { itemsPerPage: itemsPerPage, currentPage: p };
                            track user._id) {
            
                            <tr class=" 
                                  border-b border-blue-200 hover:bg-blue-50">
            
                                <!-- NAME -->
                                <td class="px-4 py-1  ">
                                    {{ user.name }}
                                </td>
            
                                <!-- ROLE -->
                                <td class="px-4 py-2 text-center">
                                    <span class="inline-flex items-center  px-3 py-1 rounded-full text-xs font-semibold capitalize"  [ngClass]="{'bg-green-100 text-green-700 border border-green-300': user.role === 'admin',  'bg-yellow-100 text-yellow-700 border border-yellow-300': user.role === 'user'}">
                                        {{ user.role }}
                                    </span>
                                </td>
                                <!-- EMAIL -->
                                <td class="px-4 py-2 text-center">
                                    {{ user.email }}
                                </td>
            
            
            
                                <!-- PERMISSIONS -->

                                
                         <!-- ACTION -->
                            <td class="flex gap-3">
                                <button (click)="openEdit(user)" class="text-blue-600 hover:underline">
                                    Edit
                                </button>
                            
                                <button (click)="deleteUser(user)" class="text-red-500 hover:underline">
                                    Delete
                                </button>
                            </td>
                            
                          @if(editUser){

                              <app-admin-add-user  [editUser]="editUser" (close)="closeSidebar()">
                            </app-admin-add-user>
                        } 

            
                            </tr>
            
                            }
                        </tbody>
            
                    </table>
                </div>
            
                <div class="mt-4 flex  flex-col gap-3
                           sm:flex-row sm:items-center sm:justify-between">
            
                    <div class="text-blue-600 text-sm font-medium
                             text-center sm:text-left ">
                        Total Users: {{ filteredUsers.length }}
                    </div>
            
                    <div  class="flex justify-center sm:justify-center w-full sm:w-auto" >

                    <pagination-controls (pageChange)="p = $event" previousLabel="Prev" nextLabel="Next" class="text-sm">
                    </pagination-controls>
                        
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>